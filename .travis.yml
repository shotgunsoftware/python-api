# Copyright (c) 2019 Shotgun Software Inc.
#
# CONFIDENTIAL AND PROPRIETARY
#
# This work is provided "AS IS" and subject to the Shotgun Pipeline Toolkit
# Source Code License included in this distribution package. See LICENSE.
# By accessing, using, copying or modifying this work you indicate your
# agreement to the Shotgun Pipeline Toolkit Source Code License. All rights
# not expressly granted therein are reserved by Shotgun Software Inc.

language: python

# We need to test on multiple distros, since python 2.6 is not supported in xenial
# and 3.7 is not supported in trusty.  For now just use trusty to test 2.6, and use
# the more modern xenial for 2.7 and 3.7.

matrix:
  include:

    # Python 2.7
    - dist: xenial
      python: "2.7"
      env:
        - RUN_FLAKE=true

    # Python 3.7
    - dist: xenial
      python: "3.7"
      env:
        - RUN_FLAKE=true

# command to install dependencies
install:
  - pip install -r tests/ci_requirements.txt
  - pip install . -U
before_script:
  - cp ./tests/example_config ./tests/config
# Run flake and then run tests
script:
  - if [ -n "$RUN_FLAKE" = true ]; then flake8; fi
  - cd tests && coverage run -m nose --no-path-adjustment
after_success: coveralls
notifications:
  email:
    - api@shotgunsoftware.com
